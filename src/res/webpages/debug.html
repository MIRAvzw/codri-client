<html>
<head>
<title>Ad-Astra III - Debug page</title>
<link rel="stylesheet" href="style.css" type="text/css" />
<script type="text/javascript">
function showMessage(message)
{
    var textarea = document.getElementById("messageView");
    if (textarea != null)   // this can happen when the DOM isn't loaded yet
    {
        var text = document.createTextNode(message);
        textarea.appendChild(text);
        textarea.scrollTop = textarea.scrollHeight;
    }
}
DebugInterface.newMessage.connect(showMessage);

function readableDuration(date1, date2)
{
    var seconds = Math.abs(date1.getTime() - date2.getTime()) / 1000;
    var text = "";
    
    var intervals = [60*60*24, 60*60, 60, 1];
    var labels = ["day", "hour", "minute", "second"];
    
    for (var i = 0; i < intervals.length; i++)
    {
        var amount = Math.floor(seconds / intervals[i]);
        if (amount > 0
            ||
            (text == "" && i == intervals.length - 1) )
        {
            seconds -= amount * intervals[i];
            if (text != "")
                text += ", ";
            text += amount + " " + labels[i];
            if (amount != 1)
                text += "s";
        }
    }
    
    return text;
}

function load()
{
    refresh();
}
function refresh()
{
    document.getElementById("uptime").innerHTML = readableDuration(new Date(), DebugInterface.startup);
    
    setTimeout("refresh()", 1000)
}
</script>
<style type="text/css">
textarea.messages {
    width: 100%;
    overflow: hidden;
    font-family: monospace;
    border: 3px solid #cccccc;
    padding: 5px;
};
</style>
</head>
<body onload="load();">
<h1>Ad-Astra III - Debug view</h1>
<h2>Application information</h2>

<table cellspacing='0' class="values" id="applicationValues">
<thead>
<tr>
<th class="Corner">Key</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<th class="key">Unique ID</td>
<td class="value"><script type="text/javascript">document.write(DebugInterface.id);</script></td>
<td class="descr">String used to identify the kiosk in the network.</td>
</tr>
<tr>
<th class="key">Startup timestamp</td>
<td class="value"><script type="text/javascript">document.write(DebugInterface.startup.toUTCString());</script></td>
<td class="descr">When the application initialized.</td>
</tr>
<tr>
<th class="key">Uptime</td>
<td class="value" id="uptime"></td>
<td class="descr">How long the application has been running.</td>
</tr>
</tbody>
</table>
<h2>Latest messages</h2>
<textarea class="messages" id="messageView" rows=10 readonly></textarea>
</body>
</html>
